(function(e){function t(t){for(var i,s,l=t[0],c=t[1],o=t[2],d=0,f=[];d<l.length;d++)s=l[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,o||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,l=1;l<n.length;l++){var c=n[l];0!==a[c]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},a={app:0},r=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var o=0;o<l.length;o++)t(l[o]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"1a79":function(e,t,n){"use strict";n("2ff5")},2199:function(e,t,n){"use strict";n("d809")},"2ff5":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"},on:{click:e.eventListener}},[n("router-view",{attrs:{urlBackend:e.urlBackend,checkAuth:e.checkAuth,out:e.out,setFiles:e.setFiles,deleteFile:e.deleteFile,addFile:e.addFile,removeEventListener:e.removeEventListener,setAID:e.setAID,setEventListener:e.setEventListener,setOldFileInfo:e.setOldFileInfo,setLoad:e.setLoad,OldFileInfo:e.OldFileInfo,load:e.load,auth:e.auth,files:e.files,AID:e.AID}})],1)},r=[],s=n("1da1"),l=(n("d3b7"),n("b0c0"),n("96cf"),n("6aaa"),{name:"App",data:function(){return{OldFileInfo:null,load:!1,files:[],AID:"",urlBackend:"http://localhost:3005",eventListener:function(){},auth:!1}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.checkAuth();case 2:case"end":return t.stop()}}),t)})))()},methods:{checkAuth:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$cookies.get("userID")){t.next=9;break}return e.load=!0,t.next=4,fetch("http://localhost:3005/api/checkAuth",{credentials:"include"});case 4:return n=t.sent,t.next=7,n.json();case 7:i=t.sent,i.data?(e.auth=!0,e.AID=i.data,e.load=!1):e.load=!1;case 9:case"end":return t.stop()}}),t)})))()},out:function(){this.$cookies.remove("userID"),this.auth=!1,this.AID="",this.files=[]},deleteFile:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,fetch("http://localhost:3005/api/deleteFile?id=".concat(e),{method:"DELETE",credentials:"include"});case 2:return n.next=4,fetch("http://localhost:3005/api/getMyFiles",{credentials:"include"});case 4:return i=n.sent,n.next=7,i.json();case 7:a=n.sent,t.files=a.data.files;case 9:case"end":return n.stop()}}),n)})))()},setEventListener:function(e){this.eventListener=e},removeEventListener:function(){this.eventListener=function(){}},setAID:function(e){this.AID=e},setLoad:function(e){this.load=e},addFile:function(e){this.files.push(e)},setFiles:function(e){this.files=e},setOldFileInfo:function(e){this.OldFileInfo={name:e.name,size:e.size,edited:e.edited,created:e.created,id:e.id,extname:e.extname,pathToFile:e.path}}}}),c=l,o=(n("034f"),n("2877")),u=Object(o["a"])(c,a,r,!1,null,null,null),d=u.exports,f=n("8c4f"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[n("div",{staticClass:"container"},[e.AID?n("div",{staticClass:"block",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},[n("router-link",{style:{color:"white",textDecoration:"none"},attrs:{to:"/files"}},[n("button",{staticClass:"btn btn-danger"},[e._v("Мои файлы")])]),n("h4",{style:{margin:0}},[e._v("Ваш AID: "+e._s(this.AID))]),n("button",{staticClass:"btn btn-primary",on:{click:e.out}},[e._v("Выйти")])],1):n("AuthForm",{attrs:{urlBackend:e.urlBackend,setAID:e.setAID}}),n("div",{staticClass:"block"},[n("h4",[e._v("Выберите файл который хотите загрузить")]),n("Form",{attrs:{urlBackend:e.urlBackend,checkAuth:e.checkAuth,addFile:e.addFile,load:e.load,setLoad:e.setLoad,setFileInfo:e.setOldFileInfo}}),e.load?n("div",{staticClass:"loader"},[e._v("Loading...")]):e._e(),n("File",{attrs:{AID:e.AID,urlBackend:e.urlBackend,fileInfo:e.OldFileInfo}})],1)],1)])},p=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.fileInfo?n("div",{staticClass:"loaded-files loaded-files-active"},[n("hr"),n("div",{staticClass:"file"},[n("div",{staticClass:"file__name"},[e._v(" "+e._s(e.fileInfo.name)+" ")]),n("div",{staticClass:"file__content"},[n("div",{staticClass:"file__content-title"},[e._v("Тип файла: "),n("div",{staticClass:"file__content-value file-type"},[e._v(e._s(e.fileInfo.extname.slice(1)))])]),n("div",{staticClass:"file__content-title"},[e._v("Размер файла: "),n("div",{staticClass:"file__content-value file-size"},[e._v(e._s(e.fileInfo.size)+"MB")])]),n("div",{staticClass:"file__content-title"},[e._v("Дата изменения файла: "),n("div",{staticClass:"file__content-value file-data-edited"},[e._v(" "+e._s(e.fileInfo.edited))])]),n("div",{staticClass:"file__content-title"},[e._v("Дата создания файла: "),n("div",{staticClass:"file__content-value file-data-created"},[e._v(e._s(e.fileInfo.created)+" ")])]),n("div",{staticClass:"file__content-title"},[e._v("Путь до файла: "),n("div",{staticClass:"file__content-value path-to-file"},[e._v(" "+e._s(e.getFullPathToFile(e.fileInfo.pathToFile))+" ")])]),n("div",{staticClass:"file__content-title"},[e._v("Ссылка на скачивание: "),n("a",{staticClass:"file__content-value link-to-file"},[n("a",{attrs:{target:"_blank",href:e.getFullPathToFile(e.fileInfo.pathToFile)}},[e._v(e._s(e.getFullPathToFile(e.fileInfo.pathToFile)))])])])])])]):n("div")},m=[],_=(n("99af"),{name:"Files",props:["fileInfo","urlBackend","pathToFile","AID"],methods:{getFullPathToFile:function(){return"".concat(location.origin,"/a/").concat(this.AID,"/").concat(this.fileInfo.id)}}}),F=_,b=Object(o["a"])(F,v,m,!1,null,"79644bce",null),I=b.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"load-file-form",on:{submit:e.submit}},[n("label",{attrs:{for:"file"}},[n("div",{staticClass:"load-file form-control"},[e._v(e._s(this.nameFile||"Нажмите чтобы загрузить файл"))]),n("input",{attrs:{name:"file",type:"file",id:"file"},on:{change:e.setFile}})]),n("button",{staticClass:"btn btn-danger",attrs:{disabled:e.load}},[e._v("Загрузить")])])},k=[],x={name:"Form",props:["setFileInfo","setLoad","load","addFile","checkAuth","urlBackend"],data:function(){return{nameFile:"",file:null}},methods:{setNameFile:function(e){this.nameFile=e},submit:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.preventDefault(),t.file){n.next=3;break}return n.abrupt("return",alert("Вы не выбрали файл"));case 3:return t.setLoad(!0),n.next=6,t.fetchFile();case 6:return i=n.sent,n.next=9,i.json();case 9:return a=n.sent,n.next=12,t.setLoad(!1);case 12:return n.next=14,t.setFileInfo(a.data);case 14:return n.next=16,t.addFile(a.data);case 16:return n.next=18,t.checkAuth();case 18:case"end":return n.stop()}}),n)})))()},fetchFile:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new FormData,n.append("file",e.file),t.next=4,fetch("".concat(e.urlBackend,"/api/loadFile"),{method:"POST",body:n,credentials:"include"});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))()},setFile:function(e){var t=e.target.files[0];this.file=t,this.setNameFile(t.name)}}},A=x,D=Object(o["a"])(A,g,k,!1,null,"1a6b00c7",null),w=D.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"block"},[n("h4",[e._v("Войти под AID")]),n("form",{on:{submit:e.submit}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.inpValue,expression:"inpValue"}],staticClass:"form-control auth-input",attrs:{type:"text",placeholder:"Введите AID"},domProps:{value:e.inpValue},on:{input:function(t){t.target.composing||(e.inpValue=t.target.value)}}}),n("button",{staticClass:"btn btn-danger auth-btn"},[e._v("Войти")])])])},C=[],O={name:"AuthForm",props:["setAID","urlBackend"],methods:{submit:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.preventDefault(),i=t.inpValue,i){n.next=4;break}return n.abrupt("return",alert("Введите Ваш AID"));case 4:return t.inpValue="",n.next=7,fetch("".concat(t.urlBackend,"/api/auth?AID=").concat(i),{credentials:"include"});case 7:return a=n.sent,n.next=10,a.json();case 10:r=n.sent,!0===r.data?t.setAID(i):alert(r.msg);case 12:case"end":return n.stop()}}),n)})))()}},data:function(){return{inpValue:""}}},j=O,L=(n("1a79"),Object(o["a"])(j,y,C,!1,null,null,null)),E=L.exports,B={name:"Main",components:{AuthForm:E,File:I,Form:w},props:["setLoad","urlBackend","addFile","setOldFileInfo","checkAuth","OldFileInfo","load","setAID","AID","setEventListener","removeEventListener","deleteFile","out"]},R=B,T=Object(o["a"])(R,h,p,!1,null,"7119ca5c",null),$=T.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[n("div",{staticClass:"container block"},[n("div",{staticClass:"files-container"},[e.files.length>0?n("div",{staticClass:"files"},e._l(e.files,(function(t){return n("div",{key:t.id,attrs:{id:t.id},on:{contextmenu:e.onContextMenu}},[n("div",{staticClass:"icon"}),n("div",{staticClass:"name"},[e._v(e._s(t.name))]),e.activeIDFile===t.id?n("div",{staticClass:"active",style:e.stylesFromActiveEl},[n("div",{staticClass:"dropdown-item pointer",on:{click:function(){return e.moreDetails(t.id)}}},[e._v("Подробнее")]),n("div",{staticClass:"dropdown-item pointer",on:{click:function(){return e.deleteFile(t.id)}}},[e._v("Удалить")])]):e._e()])})),0):0!==e.files.length||e.loaded?n("h2",{style:{textAlign:"center",display:"grid",alignItems:"center",height:"100%"}},[e._v("Loading...")]):n("h2",{style:{textAlign:"center",display:"grid",alignItems:"center",height:"100%"}},[e._v("Загрузите свой первый файл!")])]),n("div",{staticClass:"d-flex justify-content-center"},[n("router-link",{attrs:{to:"/"}},[n("button",{staticClass:"btn btn-danger exit"},[e._v("Назад")])])],1)])])},M=[],S=(n("7db0"),n("fb6a"),{name:"FileSystem",props:["setAID","urlBackend","auth","out","setFiles","checkAuth","setOldFileInfo","setLoad","files","AID","setEventListener","removeEventListener","addFile","deleteFile"],data:function(){return{activeIDFile:null,stylesFromActiveEl:{top:"0px",left:"0px"},loaded:!1}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.AID||e.auth){t.next=2;break}return t.abrupt("return",e.$router.history.push("/"));case 2:if(e.files.length){t.next=13;break}return e.loaded=!0,t.next=6,fetch("".concat(e.urlBackend,"/api/getMyFiles"),{credentials:"include"});case 6:return n=t.sent,t.next=9,n.json();case 9:i=t.sent,e.loaded=!1,i.data.auth||e.$router.history.push("/"),e.setFiles(i.data.files);case 13:case"end":return t.stop()}}),t)})))()},methods:{onContextMenu:function(e){var t=this;e.preventDefault();var n=e.target.parentElement,i=n.getAttribute("id"),a=function(){t.activeIDFile=null,t.removeEventListener()};this.setEventListener(a),this.activeIDFile=i,this.stylesFromActiveEl.top="".concat(e.y,"px"),this.stylesFromActiveEl.left="".concat(e.x,"px")},moreDetails:function(e){var t=this.files.find((function(t){return t.id===e}));if(!t)return this.$swal("Ошибка","Ошибка на стороне клиента. Пожалуйста перезагрузите страницу.","error");this.$swal({icon:"success",html:"<ul>\n    <li>".concat(t.name,"</li>\n    <li>").concat(t.size,"MB</li>\n    <li>").concat(t.extname.slice(1),"</li>\n    <li>").concat(t.created,"__CREATE</li>\n    <li>").concat(t.edited,'__EDIT</li>\n    <li><a href="').concat(location.origin,"/a/").concat(this.AID,"/").concat(t.id,'">').concat(location.origin,"/a/").concat(this.AID,"/").concat(t.id,"</a></li>\n</ul>"),title:"Информация по файлу '".concat(t.name,"'")})}}}),V=S,z=(n("2199"),Object(o["a"])(V,P,M,!1,null,"304f5f92",null)),N=z.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[0!==e.timer?n("h1",[e._v(e._s(e.timer))]):e.fileIsset?e._e():n("h1",[e._v("Ожидайте...")]),n("a",{attrs:{href:this.urlBackend+"/"+this.pathToFile}},[e.fileIsset?n("button",{staticClass:"btn btn-danger"},[e._v("Скачать файл")]):e._e()])])},q=[],G={name:"LoadFile",props:["urlBackend","checkAuth","out","setFiles","deleteFile","addFile","removeEventListener","setAID","AID","auth","userID","id","setEventListener","files","setLoad","setOldFileInfo"],data:function(){return{timer:5,checkedFileStatus:!1,fileIsset:!1,pathToFile:""}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.checkFile(),n=setInterval((function(){if(0===e.timer)return e.action(),clearInterval(n);e.timer--}),1e3);case 2:case"end":return t.stop()}}),t)})))()},methods:{action:function(){this.checkedFileStatus?this.fileIsset=!0:this.$router.push("/")},checkFile:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params,i=n.userID,a=n.id,t.next=3,fetch("".concat(e.urlBackend,"/api/issetFile?userID=").concat(i,"&fileID=").concat(a));case 3:return r=t.sent,t.next=6,r.json();case 6:s=t.sent,s.data&&(e.checkedFileStatus=!0,e.pathToFile=s.data.path);case 8:case"end":return t.stop()}}),t)})))()}}},H=G,K=Object(o["a"])(H,J,q,!1,null,"0df3bf9e",null),Q=K.exports;i["a"].use(f["a"]);var U=[{path:"/files",component:N,props:!0},{path:"/a/:userID/:id",props:!0,component:Q},{path:"*",component:$,props:!0}],W=new f["a"]({mode:"history",routes:U}),X=n("2b27"),Y=n.n(X),Z=n("5886");n("4413");i["a"].use(Z["a"]),i["a"].use(Y.a),i["a"].config.devtools=!0,i["a"].config.productionTip=!1,i["a"].$cookies.config("7d"),new i["a"]({router:W,render:function(e){return e(d)}}).$mount("#app")},"6aaa":function(e,t,n){},"85ec":function(e,t,n){},d809:function(e,t,n){}});
//# sourceMappingURL=app.8ffc8e1d.js.map